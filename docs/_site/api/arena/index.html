<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iain C Docherty - API Documents</title>
  <meta name="author" content="Iain C Docherty" />
  <meta name="description" content="The blog of Iain C Docherty" />
  <link rel="canonical" href="http://spacebotwar.com:4000/api/arena/" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="http://spacebotwar.com:4000/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="Iain C Docherty" href="http://spacebotwar.com:4000/atom.xml" />

  <link rel="stylesheet" href="http://spacebotwar.com:4000/assets/css/all.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <a href="/">
    <img src="/sp_ship.png" id="logo" alt="Site logo"/>
  </a>
  <h2><a href="/">SpaceBotWar</a>.</h2>
  <hr/>
  <h2>
  
    <a href="/api">API Documents</a>
  
  </h2>
  
    
      <h3><a href="/api/start">Start</a></h3>
    
    
      Arena
    
  
  </h2>
  <hr/>
  <h2><a href="/blog">Blog posts</a></h2>
  <hr/>
  <h2><a href="/about">About</a></h2>
  <hr/>
  <h2><a href="/faq">FAQ</a></h2>
  <hr/>
  <div>
    <div id="social">
      Follow me:
<div id="stalker">
  
  <a title="icydee on Github" href="https://github.com/icydee">
    <i class="fa fa-github-square"></i>
  </a>
  

  

  

  

  

  

  
  <a title="Iain C Docherty on Facebook" href="https://facebook.com/icydee">
    <i class="fa fa-facebook-square"></i>
  </a>
  

  

  
  <a title="Iain C Docherty on LinkedIn" href="https://www.linkedin.com/in/icydee">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  

  <a title="RSS feed" id="rss" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
</div>

    </div>
  </div>
  </ul>
</nav>

    </div>

    <div class="eleven columns content">
      <h1 id="arena_lobby">Arena Lobby</h1>

<p>All methods in this section can be carried out by a connection to the <strong>/arena/lobby</strong> route.</p>

<p>The Arena lobby will give you the names and routes to other rooms which are currently (or about to) be hosting a competition between two fleets of ships.</p>

<p>Note, rooms which are available will depend upon your login status. See the Start Lobby for details on how to login.</p>
<hr />
<h1 id="server__lobby">Server : lobby</h1>

<p>On making a Web Socket connection, the server will send a <strong>lobby</strong> message indicating the current status of the room. It may also send an update whenever the room status changes.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;code&quot;</span>          <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
    <span class='nt'>&quot;message&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;Welcome to the Arena Lobby&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;data&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;arena&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>
<h3 id="code">code</h3>

<p>The numeric code representing the status of the <strong>lobby</strong> where <strong>0</strong> represents success and any other value indicates a fault.</p>

<h3 id="message">message</h3>

<p>A human readable message, for example a message to the effect that the server is off-line.</p>

<h2 id="data">data</h2>

<p>Supplimentary data, for example the time at which the server is due back on line.</p>
<hr />
<h1 id="client__arenas">Client : arenas</h1>

<p>Get the list of all the current Arena rooms</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>  
    <span class='nt'>&quot;msg_id&quot;</span>        <span class='p'>:</span> <span class='mi'>123</span><span class='p'>,</span>
    <span class='nt'>&quot;client_code&quot;</span>   <span class='p'>:</span> <span class='s2'>&quot;1660686c-8b5d-3b7c-825d-1d828db8f9ca-2f928&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>
<h3 id="msg_id_optional">msg_id (optional)</h3>

<p>An <strong>ID</strong> to identify this message. If used the server reply will contain the same message ID. This can be useful if you wish to link the server response to the client request.</p>

<h3 id="client_code_required">client_code (required)</h3>

<p>Your client code.</p>

<h3 id="response">RESPONSE</h3>

<p>The server will respond with a <strong>Server : arenas</strong> message.</p>
<hr />
<h1 id="server__arenas">Server : arenas</h1>

<p>Server response to the <strong>Client : arenas</strong> request</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;msg_id&quot;</span>        <span class='p'>:</span> <span class='mi'>123</span><span class='p'>,</span>
    <span class='nt'>&quot;code&quot;</span>          <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
    <span class='nt'>&quot;message&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;Arenas&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;arenas&quot;</span>        <span class='p'>:</span> <span class='p'>[{</span>
        <span class='nt'>&quot;route&quot;</span>         <span class='p'>:</span> <span class='s2'>&quot;/ws/arena/gold&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;spectators&quot;</span>    <span class='p'>:</span> <span class='mi'>23</span><span class='p'>,</span>
        <span class='nt'>&quot;start_time&quot;</span>    <span class='p'>:</span> <span class='mi'>-30</span><span class='p'>,</span>
        <span class='nt'>&quot;status&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;running&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;competitors&quot;</span>       <span class='p'>:</span> <span class='p'>[{</span>
            <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Scaredy Pants&quot;</span><span class='p'>,</span>
            <span class='nt'>&quot;rank&quot;</span>          <span class='p'>:</span> <span class='mi'>37</span><span class='p'>,</span>
            <span class='nt'>&quot;programmer&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;Dr Death&quot;</span><span class='p'>,</span>
        <span class='p'>},{</span>
            <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Hunter&quot;</span><span class='p'>,</span>
            <span class='nt'>&quot;rank&quot;</span>          <span class='p'>:</span> <span class='mi'>42</span><span class='p'>,</span>
            <span class='nt'>&quot;programmer&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;Blotto&quot;</span><span class='p'>,</span>
        <span class='p'>}],</span>
    <span class='p'>},{</span>
        <span class='nt'>&quot;route&quot;</span>         <span class='p'>:</span> <span class='s2'>&quot;/ws/arena/silver&quot;</span><span class='p'>,</span>
        <span class='err'>...</span> <span class='err'>etc.</span>
    <span class='p'>}]</span>
<span class='p'>}</span>
</code></pre></div>
<p>The <strong>code</strong>, <strong>message</strong> and <strong>msg_id</strong> are the standard server response.</p>

<h3 id="arenas">arenas</h3>

<p>This is an array of all arenas available to you. Note, if you are not logged in then some rooms may not be available to you.</p>

<h4 id="route">route</h4>

<p>The Route to the arena. In order to watch a match you need to make a connection to that route. To leave a match you break the connection.</p>

<h4 id="spectators">spectators</h4>

<p>The number of other people currently viewing this match.</p>

<h4 id="start_time">start_time</h4>

<p>The time that this match started in seconds. Negative means the match has already started. Positive is the number of seconds before the match starts.</p>

<h4 id="status">status</h4>

<p>This is the status of the match, it can be one of</p>

<pre><code>* **starting** the match is currently being set up. Not yet started
* **running** the match is underway
* **closing** the match is over and a winner has been decided.</code></pre>

<h4 id="competitors">competitors</h4>

<p>The two competitors being matched against each other.</p>

<pre><code>* **name** of the program
* **rank** current rank of the program
* **programmer** name of the programmer/owner</code></pre>
<hr />
<h1 id="client__connection_to_arena">Client : connection to arena</h1>

<p>To watch a match between two competitors, you first need to make a connection to the route. A list of the current matches can be found in the <strong>lobby</strong>.</p>

<p>When you make a connection to the arena you are automatically registered to receive updates on the match progress. This is through a <strong>Server : areas_state</strong> message (see below).</p>

<p>In addition there are a number of requests you can make to the room. for all of these you should use the route to the room, e.g. <strong>arena/gold</strong></p>
<hr />
<h1 id="client__arena_status">Client : arena_status</h1>

<p>Request the current status of the room you have just joined.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;client_code&quot;</span>   <span class='p'>:</span> <span class='s2'>&quot;1660686c-8b5d-3b7c-825d-1d828db8f9ca-2f928&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>
<h3 id="msg_id_not_required">msg_id (not required)</h3>

<p>Do not issue a <strong>msg_id</strong> with this request, since the server will send multiple responses the msg_id is not honoured.</p>

<h3 id="response_2">RESPONSE</h3>

<p>The server will respond with a <strong>Server : arena_status</strong> message, immediately with the current room status, then in the future if any changes take place in the room.</p>
<hr />
<h1 id="server__arena_status">Server : arena_status</h1>

<p>The server will send this message, either on request from a <strong>Client : arena_status</strong> message, or periodically if there is a change to the arena status (e.g. a new match starts).</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;route&quot;</span>         <span class='p'>:</span> <span class='s2'>&quot;/ws/arena/gold&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;spectators&quot;</span>    <span class='p'>:</span> <span class='mi'>23</span><span class='p'>,</span>
    <span class='nt'>&quot;start_time&quot;</span>    <span class='p'>:</span> <span class='mi'>-30</span><span class='p'>,</span>
    <span class='nt'>&quot;status&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;running&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;competitors&quot;</span>       <span class='p'>:</span> <span class='p'>[{</span>
        <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Scaredy Pants&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;rank&quot;</span>          <span class='p'>:</span> <span class='mi'>37</span><span class='p'>,</span>
        <span class='nt'>&quot;programmer&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;Dr Death&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;health&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;34&quot;</span>
    <span class='p'>},{</span>
        <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Hunter&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;rank&quot;</span>          <span class='p'>:</span> <span class='mi'>42</span><span class='p'>,</span>
        <span class='nt'>&quot;programmer&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;Blotto&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;health&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;12&quot;</span>
    <span class='p'>}],</span>
<span class='p'>}</span>
</code></pre></div><hr />
<h1 id="server__match_status">Server : match_status</h1>

<p>The server will send this message periodically (every 500ms during a match) and it is intended to supply the current status, position, direction of all ships and missiles. The client can use this information to show a real-time enactment of the battle taking place. Since the data is refreshed at intervals of 500ms the client should interpolate from one 500ms <strong>tick</strong> to the next. It is acceptable for the client to lag by 500ms in order to allow interpolation to take place.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;game_time&quot;</span>     <span class='p'>:</span> <span class='mf'>43.5</span><span class='p'>,</span>
    <span class='nt'>&quot;ships&quot;</span>         <span class='p'>:</span> <span class='p'>[{</span>
        <span class='nt'>&quot;competitor&quot;</span>    <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
        <span class='nt'>&quot;ship_id&quot;</span>       <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
        <span class='nt'>&quot;x&quot;</span>             <span class='p'>:</span> <span class='mi'>2303</span><span class='p'>,</span>
        <span class='nt'>&quot;y&quot;</span>             <span class='p'>:</span> <span class='mi'>1200</span><span class='p'>,</span>
        <span class='nt'>&quot;direction&quot;</span>     <span class='p'>:</span> <span class='mf'>1.235</span><span class='p'>,</span>
        <span class='nt'>&quot;orientation&quot;</span>   <span class='p'>:</span> <span class='mf'>1.205</span><span class='p'>,</span>
        <span class='nt'>&quot;speed&quot;</span>         <span class='p'>:</span> <span class='mi'>24</span><span class='p'>,</span>
        <span class='nt'>&quot;rotation&quot;</span>      <span class='p'>:</span> <span class='mf'>-0.3</span><span class='p'>,</span>
        <span class='nt'>&quot;status&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;ok&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;health&quot;</span>        <span class='p'>:</span> <span class='mf'>85.3</span>
    <span class='p'>},{</span>
        <span class='err'>...</span>
    <span class='p'>},{</span>
        <span class='err'>...</span>
    <span class='p'>}</span>
    <span class='p'>],</span>
    <span class='nt'>&quot;missiles&quot;</span>      <span class='p'>:</span> <span class='p'>[{</span>
        <span class='nt'>&quot;competitor&quot;</span>    <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
        <span class='nt'>&quot;missile_id&quot;</span>    <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
        <span class='nt'>&quot;x&quot;</span>             <span class='p'>:</span> <span class='mi'>189</span><span class='p'>,</span>
        <span class='nt'>&quot;y&quot;</span>             <span class='p'>:</span> <span class='mi'>1399</span><span class='p'>,</span>
        <span class='nt'>&quot;direction&quot;</span>     <span class='p'>:</span> <span class='mf'>-1.34</span><span class='p'>,</span>
        <span class='nt'>&quot;speed&quot;</span>         <span class='p'>:</span> <span class='mi'>54</span><span class='p'>,</span>
        <span class='nt'>&quot;status&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;explode&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;type&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;laser&quot;</span><span class='p'>,</span>
    <span class='p'>},{</span>
        <span class='err'>...</span>
    <span class='p'>}</span>
    <span class='p'>]</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id="game_time">game_time</h2>

<p>The time from when the game started. A game starts at <strong>game_time</strong> zero so if it is negative, it means the game is being set up and has not yet started.</p>

<h2 id="ships">ships</h2>

<p>An array of all ships in the game, for all competitors. Typically there will be 12 ships, six from each competitor.</p>

<h3 id="competitor">competitor</h3>

<p>This is the index into the competitors described in the <strong>Server : status</strong> message. and will have the value zero or one.</p>

<h3 id="ship_id">ship_id</h3>

<p>A ship identifier, there being 12 ships these will be numbered zero through to eleven.</p>

<h3 id="x_and_y">x and y</h3>

<p>The X and Y co-ordinate of the ship at this point in time.</p>

<h3 id="direction">direction</h3>

<p>The direction the ship is moving, in radians, note this may be negative or positive.</p>

<h3 id="speed">speed</h3>

<p>The speed that the ship is moving (in pixels per second)</p>

<h3 id="orientation">orientation</h3>

<p>The direction the ship is pointing. Generally this will be the same as the direction of movement, unless the ship has sideways or reverse thrust.</p>

<h3 id="rotation">rotation</h3>

<p>The rate at which the orientation of the ship is changing, in radians per second. Note, a positive value means it is rotating anti-clockwise, a negative value indicates clockwise rotation.</p>

<h3 id="status_2">status</h3>

<p>The status of the ship, one of <strong>ok</strong>, <strong>damaged</strong>, or <strong>dead</strong></p>

<h3 id="health">health</h3>

<p>The health of the ship as a percentage. Ships start at 100% health and as they are damaged they lose health. At zero percent, the ship status will change (to “dead”) and the ship will be removed from the arena.</p>

<h2 id="missiles">missiles</h2>

<p>Missiles have similar attributes to ships,</p>

<h3 id="competitor_2">competitor</h3>

<p>As above.</p>

<h3 id="missile_id">missile_id</h3>

<p>All missiles are identified by a unique ID.</p>

<h3 id="x_and_y_2">x and y</h3>

<p>As above.</p>

<h3 id="direction_and_speed">direction and speed</h3>

<p>As above.</p>

<h3 id="orientation_rotation">orientation, rotation</h3>

<p>Missiles are always orientatied in the direction of their movement and they don’t rotate.</p>

<h3 id="status_3">status</h3>

<p>The status can be used to distinguish different phases of the missile. e.g. <strong>launch</strong>, <strong>running</strong>, <strong>explosion</strong></p>

<h3 id="type">type</h3>

<p>The type of the missile, may be used to indicate different missiles and images for them, e.g. <strong>laser</strong>, <strong>rocket</strong>, etc.</p>

      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © Iain C Docherty, 2013 &mdash; 
  </p>
</div>

      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxx-x']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
