<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iain C Docherty - API Documents</title>
  <meta name="author" content="Iain C Docherty" />
  <meta name="description" content="The blog of Iain C Docherty" />
  <link rel="canonical" href="http://spacebotwar.com:4000/api/" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="http://spacebotwar.com:4000/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="Iain C Docherty" href="http://spacebotwar.com:4000/atom.xml" />

  <link rel="stylesheet" href="http://spacebotwar.com:4000/assets/css/all.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <a href="/">
    <img src="/sp_ship.png" id="logo" alt="Site logo"/>
  </a>
  <h2><a href="/">SpaceBotWar</a>.</h2>
  <hr/>
  <h2>
  
    API Documents
  
  
    
      <h3><a href="/api/game">Game</a></h3>
    
  
  </h2>
  <hr/>
  <h2><a href="/blog">Blog posts</a></h2>
  <hr/>
  <h2><a href="/about">About</a></h2>
  <hr/>
  <h2><a href="/faq">FAQ</a></h2>
  <hr/>
  <div>
    <div id="social">
      Follow me:
<div id="stalker">
  
  <a title="icydee on Github" href="https://github.com/icydee">
    <i class="fa fa-github-square"></i>
  </a>
  

  

  

  

  

  

  
  <a title="Iain C Docherty on Facebook" href="https://facebook.com/icydee">
    <i class="fa fa-facebook-square"></i>
  </a>
  

  

  
  <a title="Iain C Docherty on LinkedIn" href="https://www.linkedin.com/in/icydee">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  

  <a title="RSS feed" id="rss" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
</div>

    </div>
  </div>
  </ul>
</nav>

    </div>

    <div class="eleven columns content">
      <h1 id="api_documents">API Documents</h1>

<p>This document describes the SpaceBotWar server and the open API that will enable you to interact with it.</p>

<p>The API is the same one that is used by the SpaceBotWar User Interface (UI) so anything you can do in the UI you can do from an external program.</p>

<h2 id="server">Server</h2>

<p>The playable servers are as follows.</p>

<pre><code>spacebotwar.com</code></pre>

<h2 id="web_sockets">Web Sockets</h2>

<p>The Web Servers predominatly use Web Socket technology. This offers significant advantages over HTTP requests, even AJAX calls using HTTP.</p>

<ul>
<li>The overhead for each request is much smaller making for a faster response. An AJAX call could typically have 1200 bytes of header for 8 bytes of data. For the same data in Web Socket the header is about 8 bytes.</li>

<li>It is asynchronous and full-duplex. This means the server can <em>push</em> data to the client at any time. The client no longer has to resort to frequent polling or similar techniques.</li>

<li>By only supporting Web Sockets, the server can be significantly trimmed down making it faster and cheaper. We can then scale out horizontally, providing more power at a cheaper cost.</li>
</ul>

<p>The consequence however is that your client code needs to be a little more sophisticated. We have provided several examples of simple web servers you can build upon if you wish.</p>

<h2 id="example_calls">Example Calls</h2>

<p>Here is an example connection to a Web Socket (in Perl)</p>
<div class='highlight'><pre><code class='perl'><span class='k'>use</span> <span class='nn'>AnyEvent::WebSocket::</span><span class='n'>Client</span><span class='p'>;</span>

<span class='k'>my</span> <span class='nv'>$client</span> <span class='o'>=</span> <span class='nn'>AnyEvent::WebSocket::</span><span class='n'>Client</span><span class='o'>-&gt;</span><span class='k'>new</span><span class='p'>;</span>

<span class='k'>my</span> <span class='nv'>$connection</span><span class='p'>;</span>

<span class='nv'>$client</span><span class='o'>-&gt;</span><span class='nb'>connect</span><span class='p'>(</span><span class='s'>&quot;ws://spacebotwar.com/ws/game/lobby&quot;</span><span class='p'>)</span><span class='o'>-&gt;</span><span class='n'>cb</span><span class='p'>(</span><span class='k'>sub </span><span class='p'>{</span>
    <span class='o'>...</span>
<span class='p'>});</span>
</code></pre></div>
<p>A more complete example can be found in the examples directory.</p>

<h2 id="api_hierarchy">API hierarchy</h2>

<p>The API call is split into several components.</p>

<h3 id="connection">Connection</h3>

<p>Each connection requires a separate Web Socket Connection. e.g. <strong>ws://spacebotwar.com/ws/chat</strong> is the connection to the chat system. There is also a <strong>game</strong> and an <strong>arena</strong> system. You may have a Web Socket connection into more than one of these at the same time.</p>

<h3 id="room">Room</h3>

<p>A Connection will allow you to enter one or more <strong>rooms</strong> which are just convenient localities to separate the total environment into smaller managable sections. For example in the <strong>chat</strong> system it would be hard to follow conversations if everyone was in the same room. On making a connection you should join the <strong>lobby</strong> which is a room that is always available and from which you can obtain a list of all other rooms that can be joined.</p>

<h3 id="route">Route</h3>

<p>A <strong>route</strong> defines a specific command in the API and these routes use a path-like structure to group commands with similar functionality. e.g. user account commands are <strong>/user/register</strong>, <strong>/user/login</strong> and <strong>/user/logout</strong></p>

<h2 id="web_socket_message_structure">Web Socket Message Structure</h2>

<p>A web-socket message has a JSON encoded string as it’s payload. This is an example of a server response.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span> <span class='nt'>&quot;room&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;zone_1&quot;</span><span class='p'>,</span> <span class='nt'>&quot;route&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;/user/register_status&quot;</span><span class='p'>,</span> <span class='nt'>&quot;content&quot;</span> <span class='p'>:</span> <span class='p'>{</span> <span class='nt'>&quot;code&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;0&quot;</span><span class='p'>,</span> <span class='nt'>&quot;message&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Registered&quot;</span> <span class='p'>}</span> <span class='p'>}</span>
</code></pre></div>
<p>To help to distinguish between client or server messages we will include either <strong>Server</strong> or <strong>Client</strong> in the header for each section. e.g.</p>

<h3 id="client__register">Client : Register</h3>

<p>Send a registration message from the client to the server.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;username&quot;</span>  <span class='p'>:</span> <span class='s2'>&quot;james_bond&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;password&quot;</span>  <span class='p'>:</span> <span class='s2'>&quot;topS3cret&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;email&quot;</span>     <span class='p'>:</span> <span class='s2'>&quot;agent007@mi5.gov.co.uk&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;msg_id&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;123&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>

      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © Iain C Docherty, 2013 &mdash; 
  </p>
</div>

      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxx-x']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
