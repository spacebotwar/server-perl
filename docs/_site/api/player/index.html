<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iain C Docherty - API Documents</title>
  <meta name="author" content="Iain C Docherty" />
  <meta name="description" content="The blog of Iain C Docherty" />
  <link rel="canonical" href="http://spacebotwar.com:4000/api/player/" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="http://spacebotwar.com:4000/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="Iain C Docherty" href="http://spacebotwar.com:4000/atom.xml" />

  <link rel="stylesheet" href="http://spacebotwar.com:4000/assets/css/all.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <a href="/">
    <img src="/sp_ship.png" id="logo" alt="Site logo"/>
  </a>
  <h2><a href="/">SpaceBotWar</a>.</h2>
  <hr/>
  <h2>
  
    <a href="/api">API Documents</a>
  
  </h2>
  
    
      <h3><a href="/api/start">Start</a></h3>
    
    
      <h3><a href="/api/arena">Arena</a></h3>
    
    
      <h3><a href="/api/match">Match</a></h3>
    
  
  </h2>
  <hr/>
  <h2><a href="/blog">Blog posts</a></h2>
  <hr/>
  <h2><a href="/about">About</a></h2>
  <hr/>
  <h2><a href="/faq">FAQ</a></h2>
  <hr/>
  <div>
    <div id="social">
      Follow me:
<div id="stalker">
  
  <a title="icydee on Github" href="https://github.com/icydee">
    <i class="fa fa-github-square"></i>
  </a>
  

  

  

  

  

  

  
  <a title="Iain C Docherty on Facebook" href="https://facebook.com/icydee">
    <i class="fa fa-facebook-square"></i>
  </a>
  

  

  
  <a title="Iain C Docherty on LinkedIn" href="https://www.linkedin.com/in/icydee">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  

  <a title="RSS feed" id="rss" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
</div>

    </div>
  </div>
  </ul>
</nav>

    </div>

    <div class="eleven columns content">
      <h1 id="player">Player</h1>

<p>All methods in this section can be carried out by a connection to the <strong>/ws/player</strong> server.</p>

<p>Each method appends to the route <strong>/</strong> e.g. ‘foo’ method would be on route <strong>/foo</strong></p>

<p>The Player API should only be used internally, however if the API is made open to running programs externally, on privately owned servers, then this API would need to be implemented on those servers.</p>

<p>Note. In this case the <strong>client</strong> will be the game server and the <strong>server</strong> will be the Web Socket server responsible for running the players code. This API is not intended to be called from a Web Browser (although there may be some debugging options which may make it desirable)</p>
<hr />
<h1 id="server__connect">Server : connect</h1>

<p>On making a Web Socket connection, the server will send a <strong>connect</strong> message indicating the current status of the server. It may also send an update whenever the server status changes.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;code&quot;</span>          <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
    <span class='nt'>&quot;message&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;Welcome to Darwin&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;data&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;player&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id="code">code</h2>

<p>The numeric code representing the status of the server where <strong>0</strong> represents success and any other value indicates a fault.</p>

<h2 id="message">message</h2>

<p>A human readable message, for example a message to the effect that the server is off-line.</p>

<h2 id="data">data</h2>

<p>Supplimentary data, for example the time at which the server is due back on line.</p>
<hr />
<h1 id="client__init_program">Client : init_program</h1>

<p>Initialise the server to provide the code for a new program</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;msg_id&quot;</span>        <span class='p'>:</span> <span class='mi'>123</span><span class='p'>,</span>
    <span class='nt'>&quot;server_secret&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;let&#39;s keep this between ourselves.the8g3sthe&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;program_id&quot;</span>    <span class='p'>:</span> <span class='s2'>&quot;8793ecd3a&quot;</span><span class='p'>,</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id="server_secret_required">server_secret (required)</h2>

<p>This is an identification method to reduce the chance of unauthorized use of the interface except by clients that know the server secret. Each server should specify a unique string.</p>

<h2 id="program_id_required">program_id (required)</h2>

<p>This is a unique identifier for the program (we may take this from the git commit key)</p>

<h2 id="response">RESPONSE</h2>

<p>The server responds with a <strong>Server : init_program</strong> message or an error code.</p>
<hr />
<h1 id="server__init_program">Server : init_program</h1>

<p>The server will response to a <strong>Client : init_program</strong> request.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;msg_id&quot;</span>        <span class='p'>:</span> <span class='mi'>123</span><span class='p'>,</span>
    <span class='nt'>&quot;code&quot;</span>          <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
    <span class='nt'>&quot;message&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;Program&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;program&quot;</span>        <span class='p'>:</span> <span class='p'>{</span>
        <span class='nt'>&quot;id&quot;</span>            <span class='p'>:</span> <span class='s2'>&quot;8793ecd3a&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Superbo&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;Billy&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author_id&quot;</span>     <span class='p'>:</span> <span class='mi'>5743</span><span class='p'>,</span>
        <span class='nt'>&quot;created&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;2013-01-04&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;cloned_from&quot;</span>   <span class='p'>:</span> <span class='s2'>&quot;e82671aef&quot;</span><span class='p'>,</span>
    <span class='p'>}</span>
<span class='p'>}</span>
</code></pre></div>
<p>The <strong>code</strong>, <strong>message</strong> and <strong>msg_id</strong> are the standard server response.</p>

<h2 id="program">program</h2>

<p>A hash of data representing the program that was requested.</p>

<h2 id="id">id</h2>

<p>The unique ID of the program that was requested.</p>

<h2 id="name">name</h2>

<p>The Name of the program.</p>

<h2 id="author_id">author_id</h2>

<p>The unique author ID of the person who created (or cloned and modified) this program.</p>

<h2 id="author">author</h2>

<p>The name of the author of this program.</p>

<h2 id="created">created</h2>

<p>The date that the program was created (or cloned)</p>

<h2 id="cloned_from">cloned_from</h2>

<p>If the program is a modified clone of an existing program, the unique ID of that program.</p>
<hr />
<h1 id="client__start_state">Client : start_state</h1>

<p>The client (the game server) sends the initial state of the game, this information may be sent several times during the startup period of the match. The start position and the ship stats should be cached. During the game itself, the static data will not be resent, only the variable data (see <strong>Client : next_position</strong>)</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='err'>match_id</span>    <span class='err'>:</span> <span class='err'>23432,</span>
    <span class='err'>match_time</span>  <span class='err'>:</span> <span class='err'>-5.5,</span>
    <span class='err'>competitors</span> <span class='err'>:</span> <span class='err'>[</span>
        <span class='err'>{</span>
        <span class='nt'>&quot;id&quot;</span>            <span class='p'>:</span> <span class='s2'>&quot;8793ecd3a&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Superbo&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;Billy&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author_id&quot;</span>     <span class='p'>:</span> <span class='mi'>5743</span><span class='p'>,</span>
        <span class='nt'>&quot;created&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;2013-01-04&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;cloned_from&quot;</span>   <span class='p'>:</span> <span class='s2'>&quot;e82671aef&quot;</span><span class='p'>,</span>
        <span class='p'>}</span><span class='err'>,</span>
        <span class='p'>{</span>
        <span class='nt'>&quot;id&quot;</span>            <span class='p'>:</span> <span class='s2'>&quot;023430d3a&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;name&quot;</span>          <span class='p'>:</span> <span class='s2'>&quot;Snowflake&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author&quot;</span>        <span class='p'>:</span> <span class='s2'>&quot;Arsenic&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;author_id&quot;</span>     <span class='p'>:</span> <span class='mi'>2357</span><span class='p'>,</span>
        <span class='nt'>&quot;created&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;2013-01-09&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;cloned_from&quot;</span>   <span class='p'>:</span> <span class='s2'>&quot;7582af67&quot;</span><span class='p'>,</span>
        <span class='p'>}</span>
    <span class='err'>],</span>
    <span class='err'>ships</span>       <span class='err'>:</span> <span class='p'>[</span>
        <span class='p'>{</span>
        <span class='nt'>&quot;id&quot;</span>                    <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
        <span class='nt'>&quot;competitor_id&quot;</span>         <span class='p'>:</span> <span class='s2'>&quot;023430d3a&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;name&quot;</span>                  <span class='p'>:</span> <span class='s2'>&quot;ship&quot;</span><span class='p'>,</span>
        <span class='nt'>&quot;x&quot;</span>                     <span class='p'>:</span> <span class='mi'>340</span><span class='p'>,</span>
        <span class='nt'>&quot;y&quot;</span>                     <span class='p'>:</span> <span class='mi'>450</span><span class='p'>,</span>
        <span class='nt'>&quot;orientation&quot;</span>           <span class='p'>:</span> <span class='mf'>1.23</span><span class='p'>,</span>
        <span class='nt'>&quot;max_thrust_forward&quot;</span>    <span class='p'>:</span> <span class='mi'>60</span><span class='p'>,</span>
        <span class='nt'>&quot;max_thrust_sideway&quot;</span>    <span class='p'>:</span> <span class='mi'>20</span><span class='p'>,</span>
        <span class='nt'>&quot;max_thrust_reverse&quot;</span>    <span class='p'>:</span> <span class='mi'>30</span>
        <span class='s2'>&quot;max_rotation&quot;</span>          <span class='p'>:</span> <span class='mf'>1.5</span><span class='p'>,</span>
        <span class='p'>},</span>
        <span class='err'>...</span>
    <span class='p'>]</span><span class='err'>,</span>
<span class='err'>}</span>
</code></pre></div>
<h2 id="match_id">match_id</h2>

<p>The unique identifier for the match.</p>

<h2 id="match_time">match_time</h2>

<p>The time, in seconds, from the start of the match, during the startup phase of the match this will be negative, and represents the time until the match starts.</p>

<h2 id="competitors">competitors</h2>

<p>Information about the (two) competitors</p>

<h3 id="id_2">id</h3>

<p>The unique ID of the program</p>

<h3 id="name_2">name</h3>

<p>The name of the program</p>

<h3 id="author_2">author</h3>

<p>The name of the author of the program.</p>

<h3 id="author_id_2">author_id</h3>

<p>A unique ID for the author</p>

<h3 id="created_2">created</h3>

<p>The date at which the program was last modified.</p>

<h3 id="cloned_from_2">cloned from</h3>

<p>The ID of the program this one was cloned from (or blank if it is a totally new program)</p>

<h2 id="ships">ships</h2>

<p>An array of all ships, from both competitors, taking part in the match.</p>

<h3 id="id_3">id</h3>

<p>The unique ID of the ship.</p>

<h3 id="competitor_id">competitor_id</h3>

<p>The unique ID of the competitor</p>

<h3 id="name_3">name</h3>

<p>The name of the ship.</p>

<h3 id="x">x</h3>

<p>The start X co-ordinate of the ship in the arena</p>

<h3 id="y">y</h3>

<p>The start Y co-ordinate of the ship in the arena</p>

<h3 id="orientation">orientation</h3>

<p>The start orientation (direction it is pointing) of the ship in Radians</p>

<h3 id="max_forward_thrust">max_forward_thrust</h3>

<p>The maximum allowable forward thrust of the ship.</p>

<h3 id="max_reverse_thrust">max_reverse_thrust</h3>

<p>The maximum allowable reverse thrust of the ship.</p>

<h3 id="max_sideway_thrust">max_sideway_thrust</h3>

<p>The absolute maximum allowable sideways thrust of the ship (note sideway thrust may be positive or negative)</p>

<h3 id="max_rotation">max_rotation</h3>

<p>The absolute maximum allowable rotation speed of the ship in Radians/sec (note rotation may be negative or positive.</p>

<h2 id="response_2">RESPONSE</h2>

<p>There is no response necessary from the server.</p>
<hr />
<h1 id="client__game_state">Client : game_state</h1>

<p>The current state of the game (sent once the match has started)</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
    <span class='nt'>&quot;code&quot;</span>          <span class='p'>:</span> <span class='mi'>0</span><span class='p'>,</span>
    <span class='nt'>&quot;message&quot;</span>       <span class='p'>:</span> <span class='s2'>&quot;Match&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;match_id&quot;</span>      <span class='p'>:</span> <span class='mi'>23432</span><span class='p'>,</span>
    <span class='nt'>&quot;match_time&quot;</span>    <span class='p'>:</span> <span class='mf'>-5.5</span><span class='p'>,</span>
    <span class='nt'>&quot;spectators&quot;</span>    <span class='p'>:</span> <span class='mi'>3</span><span class='p'>,</span>
    <span class='nt'>&quot;ships       : [</span>
<span class='nt'>        {</span>
<span class='nt'>        &quot;</span><span class='err'>id</span><span class='s2'>&quot;                    : 0,</span>
<span class='s2'>        &quot;</span><span class='err'>direction</span><span class='s2'>&quot;             : 1.35,</span>
<span class='s2'>        &quot;</span><span class='err'>orientation</span><span class='s2'>&quot;           : 1.23,</span>
<span class='s2'>        &quot;</span><span class='err'>speed&quot;</span>                 <span class='p'>:</span> <span class='mi'>60</span><span class='p'>,</span>
        <span class='p'>}</span><span class='err'>,</span>
        <span class='err'>...</span>
    <span class='err'>],</span>
<span class='err'>}</span>
</code></pre></div>
<p>This is sent out every 500ms to all players. The message is cut down to the minimum, only giving enough information to identify the ship and the dynamic (variable) data such as speed and direction. The static information on ships was provided via the <strong>start_status</strong> message which should be cached.</p>

<h2 id="match_id_2">match_id</h2>

<p>The unique ID of the match.</p>

<h2 id="match_time_2">match_time</h2>

<p>The current time of the match, in seconds, since the game started.</p>

<h2 id="spectators">spectators</h2>

<p>The number of people watching the match</p>

<h2 id="ships_2">ships</h2>

<p>An array of all ships in the game, both the current player and the competitor.</p>

<h2 id="id_4">id</h2>

<p>A unique ID for the ship</p>

<h2 id="direction">direction</h2>

<p>The direction the ship is currently moving in (based on the vector of all three thrust directions)</p>

<h2 id="orientation_2">orientation</h2>

<p>The current orientation of the ship (it may be different to the direction the ship is moving, for example if it has sideways thrust)</p>

<h2 id="speed">speed</h2>

<p>The current speed of the ship (based on a vector of all the thrusts) if it is at zero, the ship is stationary.</p>

      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © Iain C Docherty, 2013 &mdash; 
  </p>
</div>

      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxx-x']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
